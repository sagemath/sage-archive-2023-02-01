#!/usr/bin/env bash

if [ -z "$SAGE_LOCAL" ]; then
    echo >&2 "Error: SAGE_LOCAL undefined - exiting..."
    exit 1
fi

# Note: Running the test suite should not involve (re)compilation,
#       so we don't set CFLAGS et al. here.

cd src

echo "Running the GMP-ECM test suite..."

$MAKE check

if [ $? -ne 0 ]; then
    echo >&2 "Error: The GMP-ECM test suite failed."
    exit 1
fi

echo "The GMP-ECM test suite passed."
